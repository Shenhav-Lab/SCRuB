<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>SCRuB Tutorial</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/darkly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">SCRuB</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="tutorial.html">
    <span class="fa fa-book"></span>
     
    Tutorial
  </a>
</li>
<li>
  <a href="prescrub_intro.html">
    <span class="fa fa-object-group"></span>
     
    preSCRuB
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-gear"></span>
     
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">SCRuB Manuscript</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/korem-lab/SCRuB/issues">
    <span class="fa fa-question fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/korem-lab/SCRuB/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">SCRuB Tutorial</h1>

</div>


<style>
    body { background-color: #162138;
            text-color: whitesmoke}
</style>
<p><img src='images/SCRuB_logo.png' align="right" height="139" /></p>
<p>In this tutorial, we demonstrate how SCRuB should be used to remove contamination from microbial samples. All you need to run SCRuB is a count matrix of control and non-control samples. To run the SCRuB with its full spatial component, which is strongly recommended, the well locations of each sample must also be provided.</p>
<hr />
<div id="section" class="section level1 tabset">
<h1 class="tabset"></h1>
<div id="loading-the-data" class="section level2">
<h2>Loading the data</h2>
<p>The starting point for SCRuB is a matrix, in which each row represents a sample, and each column represents each sample’s read counts that correspond to a certain taxa (e.g ASV, OTU, species). In general, we recommend to run SCRuB on the most granular version of the data possible, and so data should only be grouped to higher orders of phylogeny (e.g. genus, family…) <em>after</em> completing the SCRuB pipeline.</p>
<p>We start by loading the necessary packages, such as <code>SCRUB</code>. We also include the use of <code>tidyverse</code> within our tutorial</p>
<pre class="r"><code>library(tidyverse)
library(SCRuB)</code></pre>
<p>As an example dataset, we use processed samples publicly available from Qiita (<strong>link</strong>), from a dataset of hospital samples, original from surfaces, patients, and blank controls. In the ensuing pipeline, we demonstrate how SCRuB can be used to remove the contamination from the hospital and patient samples. We demonstrates the SCRuB pipeline on one of the 6 plates from the dataset.</p>
<pre class="r"><code>data &lt;- read.csv(&#39;tutorial_data/hospital.csv&#39;, row.names=1) %&gt;% as.matrix()
dim(data)</code></pre>
<pre><code>## [1]   95 9099</code></pre>
<p>Let’s take a look at the row names, which in this case we will use to identify the control samples, which include <code>blank</code> in the row name.</p>
<pre class="r"><code>row.names(data)</code></pre>
<pre><code>##  [1] &quot;13092.000117069.covid&quot;  &quot;13092.000117067.covid&quot;  &quot;13092.000117455.covid&quot; 
##  [4] &quot;13092.000117057.covid&quot;  &quot;13092.000117159.covid&quot;  &quot;13092.000117160.covid&quot; 
##  [7] &quot;13092.000117228.covid&quot;  &quot;13092.000117229.covid&quot;  &quot;13092.000117246.covid&quot; 
## [10] &quot;13092.000117260.covid&quot;  &quot;13092.000117263.covid&quot;  &quot;13092.000117438.covid&quot; 
## [13] &quot;13092.000117450.covid&quot;  &quot;13092.000117055.covid&quot;  &quot;13092.000117755.covid&quot; 
## [16] &quot;13092.000117089.covid&quot;  &quot;13092.000117258.covid&quot;  &quot;13092.000117374.covid&quot; 
## [19] &quot;13092.000117445.covid&quot;  &quot;13092.000117756.covid&quot;  &quot;13092.000117462.covid&quot; 
## [22] &quot;13092.000117394.covid&quot;  &quot;13092.000117519.covid&quot;  &quot;13092.000117059.covid&quot; 
## [25] &quot;13092.000117090.covid&quot;  &quot;13092.000117434.covid&quot;  &quot;13092.v2.7.ZymoMock.B7&quot;
## [28] &quot;13092.v2.7.ZymoMock.C7&quot; &quot;13092.000117521.covid&quot;  &quot;13092.v2.7.ZymoMock.A7&quot;
## [31] &quot;13092.000117386.covid&quot;  &quot;13092.000117390.covid&quot;  &quot;13092.000117398.covid&quot; 
## [34] &quot;13092.000117414.covid&quot;  &quot;13092.000117466.covid&quot;  &quot;13092.v2.7.ZymoMock.D7&quot;
## [37] &quot;13092.000117402.covid&quot;  &quot;13092.000117407.covid&quot;  &quot;13092.000117422.covid&quot; 
## [40] &quot;13092.000117458.covid&quot;  &quot;13092.000117470.covid&quot;  &quot;13092.000117517.covid&quot; 
## [43] &quot;13092.000117248.covid&quot;  &quot;13092.000117494.covid&quot;  &quot;13092.000117513.covid&quot; 
## [46] &quot;13092.000117060.covid&quot;  &quot;13092.000117523.covid&quot;  &quot;13092.000117056.covid&quot; 
## [49] &quot;13092.000117410.covid&quot;  &quot;13092.000117068.covid&quot;  &quot;13092.000117087.covid&quot; 
## [52] &quot;13092.000117257.covid&quot;  &quot;13092.000117261.covid&quot;  &quot;13092.000117426.covid&quot; 
## [55] &quot;13092.000117506.covid&quot;  &quot;13092.000117065.covid&quot;  &quot;13092.000117070.covid&quot; 
## [58] &quot;13092.87.covid&quot;         &quot;13092.000117259.covid&quot;  &quot;13092.000117053.covid&quot; 
## [61] &quot;13092.000117454.covid&quot;  &quot;13092.000117247.covid&quot;  &quot;13092.000117418.covid&quot; 
## [64] &quot;13092.000117524.covid&quot;  &quot;13092.000117498.covid&quot;  &quot;13092.000118432.covid&quot; 
## [67] &quot;13092.000117088.covid&quot;  &quot;13092.000117054.covid&quot;  &quot;13092.000117757.covid&quot; 
## [70] &quot;13092.000117086.covid&quot;  &quot;13092.84.covid&quot;         &quot;13092.85.covid&quot;        
## [73] &quot;13092.v2.7.ZymoMock.H7&quot; &quot;13092.000117264.covid&quot;  &quot;13092.000117227.covid&quot; 
## [76] &quot;13092.000117066.covid&quot;  &quot;13092.v2.7.ZymoMock.G7&quot; &quot;13092.v2.7.ZymoMock.E7&quot;
## [79] &quot;13092.000117442.covid&quot;  &quot;13092.000117071.covid&quot;  &quot;13092.v2.7.ZymoMock.F7&quot;
## [82] &quot;13092.v2.7.blank.C6&quot;    &quot;13092.v2.7.blank.E6&quot;    &quot;13092.v2.7.blank.F12&quot;  
## [85] &quot;13092.v2.7.blank.A12&quot;   &quot;13092.v2.7.blank.D6&quot;    &quot;13092.v2.7.blank.E12&quot;  
## [88] &quot;13092.v2.7.blank.H6&quot;    &quot;13092.v2.7.blank.H11&quot;   &quot;13092.v2.7.blank.B12&quot;  
## [91] &quot;13092.v2.7.blank.C12&quot;   &quot;13092.v2.7.blank.A6&quot;    &quot;13092.v2.7.blank.F6&quot;   
## [94] &quot;13092.v2.7.blank.B6&quot;    &quot;13092.v2.7.blank.D12&quot;</code></pre>
</div>
<div id="scrub" class="section level2">
<h2>SCRuB</h2>
<div id="running-scrub" class="section level3">
<h3>Running SCRuB</h3>
<pre class="r"><code>control_indices &lt;- row.names(data) %&gt;% str_detect(&#39;blank&#39;)
scr_out &lt;- SCRUB( samples = data[control_indices==F, ], 
                  controls = data[control_indices, ],
                  print_loglikelihood = T )</code></pre>
<pre><code>## [1] &quot;Log-Likelihood of -4324736.96106286 after 1 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324054.73071944 after 2 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324027.87870818 after 3 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324012.5095419 after 4 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324007.85313632 after 5 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.77596403 after 6 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.50967902 after 7 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.43615226 after 8 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.41649572 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.41250882 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.4126404 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.41351096 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.41426722 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.41478222 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4324006.41510251 after 501 iterations!&quot;</code></pre>
</div>
<div id="evaluating-the-outputs" class="section level3">
<h3>Evaluating the outputs</h3>
<p>Let’s take a look at the results. The estimated level of contamination was very low, as the fitted <code>p</code> parameters indicate our samples are close to <code>0%</code> contamination.</p>
<pre class="r"><code>scr_out$p %&gt;% boxplot()</code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>To take a look at the cleaned samples, refer to the <code>decontaminated_samples</code> entry.</p>
<pre class="r"><code>decontaminated_samples &lt;- scr_out$decontaminated_samples
decontaminated_samples[1:5, 1:5]</code></pre>
<pre><code>##                       X1124701 X4479944 X1050608 X1124709 X185100
## 13092.000117069.covid        0        4        0        0       0
## 13092.000117067.covid        0        1        0        0       0
## 13092.000117455.covid        0      102        0        0       0
## 13092.000117057.covid        0        0        2        0       0
## 13092.000117159.covid        0        0        4       27       0</code></pre>
<p>The last output of the SCRUB function is the <code>gamma</code> parameter, which is a vector representing the estimated relative abundance of the contamination community.</p>
<pre class="r"><code>scr_out$gamma %&gt;% plot()</code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="spatial-scrub" class="section level2">
<h2>Spatial SCRuB</h2>
<p>It is strongly recommended to incorporate the well metadata of each sample into SCRuB, as this makes it possible ot directly account for potential well leakage into negative controls, reducing the risk of wrongly removing certain species during decontamination.</p>
<p>To start, we load the metadata and create a distance matrix between each sample, in which each row/column name corresponds to the rows identifying each sample from our data.</p>
<pre class="r"><code>well_metadata &lt;- read.csv(&#39;tutorial_data/well_metadata.csv&#39;, row.names=2)[row.names(data), ] %&gt;% 
        select(na_plate_location) %&gt;% 
        mutate(well = na_plate_location %&gt;% sapply( function(x) which( LETTERS == substr(x, 1, 1) ) ),
                               indices = na_plate_location %&gt;% sapply( function(x) substr(x, 2, 3) %&gt;% as.integer)
                                 )

print( well_metadata %&gt;% select(na_plate_location, well, indices) %&gt;% head() )</code></pre>
<pre><code>##                       na_plate_location well indices
## 13092.000117069.covid                B1    2       1
## 13092.000117067.covid                D2    4       2
## 13092.000117455.covid               H12    8      12
## 13092.000117057.covid                C5    3       5
## 13092.000117159.covid                B5    2       5
## 13092.000117160.covid                H4    8       4</code></pre>
<p>Let’s take a look at the negative controls placement strategy: <img src="tutorial_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>To build a distanct matrix, we use the <code>dist</code> function</p>
<pre class="r"><code>distance_matrix &lt;- well_metadata %&gt;% select(well, indices) %&gt;%
                      dist(method = &#39;euclidean&#39;) %&gt;% as.matrix() %&gt;% round(2)

distance_matrix[1:5, 1:5]</code></pre>
<pre><code>##                       13092.000117069.covid 13092.000117067.covid
## 13092.000117069.covid                  0.00                  2.24
## 13092.000117067.covid                  2.24                  0.00
## 13092.000117455.covid                 12.53                 10.77
## 13092.000117057.covid                  4.12                  3.16
## 13092.000117159.covid                  4.00                  3.61
##                       13092.000117455.covid 13092.000117057.covid
## 13092.000117069.covid                 12.53                  4.12
## 13092.000117067.covid                 10.77                  3.16
## 13092.000117455.covid                  0.00                  8.60
## 13092.000117057.covid                  8.60                  0.00
## 13092.000117159.covid                  9.22                  1.00
##                       13092.000117159.covid
## 13092.000117069.covid                  4.00
## 13092.000117067.covid                  3.61
## 13092.000117455.covid                  9.22
## 13092.000117057.covid                  1.00
## 13092.000117159.covid                  0.00</code></pre>
<pre class="r"><code>sp_scr_out &lt;- spatial_SCRUB(data = data, 
                            is_control=control_indices, 
                            well_dists = distance_matrix, 
                            print_loglikelihood = TRUE
                            )</code></pre>
<pre><code>## [1] &quot;Log-Likelihood of -4394722.90077628 after 1 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393488.46293399 after 2 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393336.40817118 after 3 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393289.38406632 after 4 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393266.44018431 after 5 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393251.54155815 after 6 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393241.92771187 after 7 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393234.98360133 after 8 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393226.61081576 after 9 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393214.61968893 after 10 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393199.57896945 after 11 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393182.29747148 after 12 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393167.96369441 after 13 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393160.66267 after 14 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393158.32717576 after 15 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.80558162 after 16 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.70253607 after 17 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.64626962 after 18 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.60035511 after 19 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.56530844 after 20 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.50512679 after 21 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.48342376 after 22 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.4658192 after 23 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.44527668 after 24 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.4253292 after 25 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.39367513 after 26 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.38231273 after 27 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.3673961 after 28 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.35456551 after 28 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.33045369 after 28 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.32111877 after 28 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.3026215 after 28 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.29010296 after 28 iterations!&quot;
## [1] &quot;Log-Likelihood of -4393157.27908531 after 501 iterations!&quot;</code></pre>
<p>Let’s take a look at the results, 3 of which are the same as the output to the <code>SCRUB</code> function. The estimated level of contamination was very low, as the fitted <code>p</code> parameters indicate our samples are close to <code>0%</code> contamination.</p>
<pre class="r"><code>sp_scr_out$p %&gt;% boxplot()</code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>To take a look at the cleaned samples, refer to the <code>decontaminated_samples</code> entry.</p>
<pre class="r"><code>decontaminated_samples &lt;- sp_scr_out$decontaminated_samples
decontaminated_samples[1:5, 1:5]</code></pre>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    0    4    0    0    0
## [2,]    0    1    0    0    0
## [3,]    0  102    0    0    0
## [4,]    0    0    2    0    0
## [5,]    0    0    4   27    0</code></pre>
<p>The last output of the SCRUB function is the <code>gamma</code> parameter, which is a vector representing the estimated relative abundance of the contamination community.</p>
<pre class="r"><code>sp_scr_out$gamma %&gt;% plot()</code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>One additional output is the <code>alpha</code> parameters, which is a <code>n_control</code> by <code>n_samples + 1</code> matrix that represents the estimated level of leakage into each control. The last column of the <code>alpha</code> matrix represents the estimated proportion of each control that originates from the contamination source. In this case, <code>SCRuB</code> estimated a high level of leakage for many samples, with a median estimated well-to-well leakge of <code>25%</code>.</p>
<pre class="r"><code>boxplot( sp_scr_out$alpha[, ncol(sp_scr_out$alpha)] )</code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
